<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lazarus - Where Ideas Come to Life</title>
    <meta name="description" content="The most beautiful and creative blogging platform with 14 animated themes, AI assistant, and professional writing tools.">
    <meta name="keywords" content="blog, writing, Medium alternative, blogging platform, creative writing">
    <meta name="author" content="Lazarus">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Lazarus - Where Ideas Come to Life">
    <meta property="og:description" content="The most beautiful blogging platform with 14 themes, AI assistant, and amazing features.">
    <meta property="og:image" content="https://via.placeholder.com/1200x630/667eea/ffffff?text=Lazarus">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="Lazarus - Where Ideas Come to Life">
    <meta property="twitter:description" content="The most beautiful blogging platform">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üê∫</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700;900&family=Inter:wght@300;400;500;600;700;800&family=Fira+Code:wght@400;500&family=Merriweather:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        :root {
            --bg-primary: #0a0e27;
            --bg-secondary: #12172e;
            --bg-tertiary: #1e2749;
            --text-primary: #e0e6ed;
            --text-secondary: #a0aec0;
            --text-muted: #718096;
            --accent-primary: #667eea;
            --accent-secondary: #764ba2;
            --border-color: #1e2749;
        }

        [data-theme="light"] {
            --bg-primary: #ffffff;
            --bg-secondary: #f7fafc;
            --bg-tertiary: #edf2f7;
            --text-primary: #1a202c;
            --text-secondary: #4a5568;
            --text-muted: #718096;
            --accent-primary: #667eea;
            --accent-secondary: #764ba2;
            --border-color: #e2e8f0;
        }

        [data-theme="ocean"] {
            --bg-primary: #0a1628;
            --bg-secondary: #112240;
            --bg-tertiary: #1e3a5f;
            --text-primary: #ccd6f6;
            --text-secondary: #8892b0;
            --text-muted: #64ffda;
            --accent-primary: #64ffda;
            --accent-secondary: #00d4ff;
            --border-color: #233554;
        }

        [data-theme="forest"] {
            --bg-primary: #0d1b0d;
            --bg-secondary: #1a2f1a;
            --bg-tertiary: #2d4a2d;
            --text-primary: #e8f5e9;
            --text-secondary: #a5d6a7;
            --text-muted: #81c784;
            --accent-primary: #66bb6a;
            --accent-secondary: #43a047;
            --border-color: #2d4a2d;
        }

        [data-theme="sunset"] {
            --bg-primary: #1a1625;
            --bg-secondary: #2d1b3d;
            --bg-tertiary: #4a2855;
            --text-primary: #ffd4e5;
            --text-secondary: #ffb3d9;
            --text-muted: #ff85c0;
            --accent-primary: #ff6b9d;
            --accent-secondary: #ff8c42;
            --border-color: #5a2d6b;
        }

        [data-theme="cyberpunk"] {
            --bg-primary: #0d0221;
            --bg-secondary: #160933;
            --bg-tertiary: #240046;
            --text-primary: #00ffff;
            --text-secondary: #ff00ff;
            --text-muted: #ff0080;
            --accent-primary: #ff0080;
            --accent-secondary: #00ffff;
            --border-color: #3c096c;
        }

        [data-theme="cherry"] {
            --bg-primary: #2d0a1f;
            --bg-secondary: #4a0e2e;
            --bg-tertiary: #6b1544;
            --text-primary: #ffe6f0;
            --text-secondary: #ffb3d4;
            --text-muted: #ff85b8;
            --accent-primary: #ff1654;
            --accent-secondary: #ff4081;
            --border-color: #8b1e5a;
        }

        [data-theme="golden"] {
            --bg-primary: #1a1510;
            --bg-secondary: #2d2418;
            --bg-tertiary: #4a3c28;
            --text-primary: #fff8dc;
            --text-secondary: #f4d58d;
            --text-muted: #e8aa42;
            --accent-primary: #ffd700;
            --accent-secondary: #ff9500;
            --border-color: #5a4a38;
        }

        [data-theme="aurora"] {
            --bg-primary: #0c1821;
            --bg-secondary: #1b2a41;
            --bg-tertiary: #2d4059;
            --text-primary: #d5f4e6;
            --text-secondary: #80ced7;
            --text-muted: #63768d;
            --accent-primary: #00ffb9;
            --accent-secondary: #a0e7e5;
            --border-color: #3d5a80;
        }

        [data-theme="lavender"] {
            --bg-primary: #1a0f2e;
            --bg-secondary: #2d1b4e;
            --bg-tertiary: #432e7e;
            --text-primary: #f0e6ff;
            --text-secondary: #d4b5ff;
            --text-muted: #b794f6;
            --accent-primary: #9f7aea;
            --accent-secondary: #d6bcfa;
            --border-color: #5a3f9e;
        }

        [data-theme="mint"] {
            --bg-primary: #0f1e1a;
            --bg-secondary: #1a332c;
            --bg-tertiary: #2d524a;
            --text-primary: #e6fff9;
            --text-secondary: #a7f3d0;
            --text-muted: #6ee7b7;
            --accent-primary: #34d399;
            --accent-secondary: #10b981;
            --border-color: #3d6b5f;
        }

        [data-theme="rose"] {
            --bg-primary: #1f0a14;
            --bg-secondary: #331122;
            --bg-tertiary: #4d1a33;
            --text-primary: #fff0f5;
            --text-secondary: #ffc4dd;
            --text-muted: #ff9ec4;
            --accent-primary: #ff6fa8;
            --accent-secondary: #ff4d8c;
            --border-color: #6d2a4d;
        }

        [data-theme="galaxy"] {
            --bg-primary: #0a0015;
            --bg-secondary: #1a0033;
            --bg-tertiary: #2d0055;
            --text-primary: #e6d9ff;
            --text-secondary: #b799ff;
            --text-muted: #8b66ff;
            --accent-primary: #6b3aff;
            --accent-secondary: #9d5cff;
            --border-color: #3d0066;
        }

        [data-theme="fire"] {
            --bg-primary: #1a0800;
            --bg-secondary: #2d1100;
            --bg-tertiary: #4a1c00;
            --text-primary: #ffe6cc;
            --text-secondary: #ffb380;
            --text-muted: #ff884d;
            --accent-primary: #ff4500;
            --accent-secondary: #ff6347;
            --border-color: #5a2d00;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            transition: background-color 0.5s ease, color 0.5s ease;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            opacity: 0.05;
            background-image: 
                radial-gradient(circle at 20% 50%, var(--accent-primary) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, var(--accent-secondary) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, var(--accent-primary) 0%, transparent 50%);
            animation: floatingGradient 20s ease-in-out infinite;
        }

        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            opacity: 0.02;
        }

        [data-theme="ocean"]::after {
            background-image: 
                repeating-linear-gradient(0deg, transparent, transparent 2px, var(--accent-primary) 2px, var(--accent-primary) 4px),
                repeating-linear-gradient(90deg, transparent, transparent 2px, var(--accent-secondary) 2px, var(--accent-secondary) 4px);
            animation: wave 15s linear infinite;
        }

        [data-theme="cyberpunk"]::after {
            background-image: 
                linear-gradient(0deg, transparent 24%, var(--accent-primary) 25%, var(--accent-primary) 26%, transparent 27%, transparent 74%, var(--accent-secondary) 75%, var(--accent-secondary) 76%, transparent 77%, transparent),
                linear-gradient(90deg, transparent 24%, var(--accent-primary) 25%, var(--accent-primary) 26%, transparent 27%, transparent 74%, var(--accent-secondary) 75%, var(--accent-secondary) 76%, transparent 77%, transparent);
            background-size: 50px 50px;
            animation: gridMove 20s linear infinite;
        }

        [data-theme="galaxy"]::after {
            background-image: 
                radial-gradient(2px 2px at 20px 30px, white, transparent),
                radial-gradient(2px 2px at 60px 70px, white, transparent),
                radial-gradient(1px 1px at 50px 50px, white, transparent),
                radial-gradient(1px 1px at 130px 80px, white, transparent),
                radial-gradient(2px 2px at 90px 10px, white, transparent);
            background-size: 200px 200px;
            animation: stars 100s linear infinite;
        }

        [data-theme="forest"]::after {
            background-image: 
                linear-gradient(135deg, var(--accent-primary) 25%, transparent 25%),
                linear-gradient(225deg, var(--accent-primary) 25%, transparent 25%),
                linear-gradient(45deg, var(--accent-primary) 25%, transparent 25%),
                linear-gradient(315deg, var(--accent-primary) 25%, transparent 25%);
            background-position: 10px 0, 10px 0, 0 0, 0 0;
            background-size: 20px 20px;
            opacity: 0.05;
        }

        [data-theme="sunset"]::after {
            background: linear-gradient(180deg, 
                var(--accent-secondary) 0%, 
                var(--accent-primary) 30%, 
                transparent 50%);
            opacity: 0.1;
        }

        [data-theme="fire"]::after {
            background-image: 
                radial-gradient(circle at 50% 0%, var(--accent-primary) 0%, transparent 50%),
                radial-gradient(circle at 30% 20%, var(--accent-secondary) 0%, transparent 40%),
                radial-gradient(circle at 70% 15%, var(--accent-primary) 0%, transparent 35%);
            animation: fireFlicker 3s ease-in-out infinite;
        }

        [data-theme="cherry"]::after {
            background-image: 
                radial-gradient(circle, var(--accent-primary) 1px, transparent 1px),
                radial-gradient(circle, var(--accent-secondary) 1px, transparent 1px);
            background-size: 50px 50px, 80px 80px;
            background-position: 0 0, 40px 40px;
            opacity: 0.08;
            animation: float 30s ease-in-out infinite;
        }

        [data-theme="lavender"]::after {
            background-image: 
                linear-gradient(30deg, var(--accent-primary) 12%, transparent 12.5%, transparent 87%, var(--accent-primary) 87.5%, var(--accent-primary)),
                linear-gradient(150deg, var(--accent-primary) 12%, transparent 12.5%, transparent 87%, var(--accent-primary) 87.5%, var(--accent-primary));
            background-size: 80px 140px;
            opacity: 0.04;
        }

        [data-theme="aurora"]::after {
            background: linear-gradient(125deg, 
                transparent 0%, 
                var(--accent-primary) 40%, 
                var(--accent-secondary) 60%, 
                transparent 100%);
            opacity: 0.08;
            animation: aurora 15s ease-in-out infinite;
        }

        @keyframes wave {
            0% { transform: translateX(0) translateY(0); }
            100% { transform: translateX(50px) translateY(50px); }
        }

        @keyframes gridMove {
            0% { background-position: 0 0; }
            100% { background-position: 50px 50px; }
        }

        @keyframes stars {
            0% { transform: translateY(0); }
            100% { transform: translateY(-200px); }
        }

        @keyframes fireFlicker {
            0%, 100% { opacity: 0.05; }
            50% { opacity: 0.15; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        @keyframes aurora {
            0%, 100% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(5deg) scale(1.1); }
        }

        @keyframes floatingGradient {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(30px, -30px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.9); }
        }

        header, .container, .hero, .modal-content, .chat-window {
            position: relative;
            z-index: 1;
        }

        header {
            background-color: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 16px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-family: 'Playfair Display', serif;
            font-size: 38px;
            font-weight: 900;
            background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -2px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logo:hover {
            transform: scale(1.05);
            filter: brightness(1.2);
        }

        .reading-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            z-index: 10000;
            transition: width 0.1s ease;
            box-shadow: 0 0 10px var(--accent-primary);
        }

        nav {
            display: flex;
            gap: 16px;
            align-items: center;
        }

        nav a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: color 0.2s;
            cursor: pointer;
            white-space: nowrap;
        }

        nav a:hover {
            color: var(--accent-primary);
        }

        #authButtons {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 24px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            font-size: 14px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: transparent;
            color: var(--accent-primary);
            padding: 10px 20px;
            border-radius: 24px;
            border: 1px solid var(--accent-primary);
            font-weight: 600;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .btn-secondary:hover {
            background: var(--accent-primary);
            color: white;
        }

        .btn-danger {
            background: #f56565;
            color: white;
            padding: 6px 12px;
            border-radius: 16px;
            border: none;
            font-weight: 500;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
        }

        .btn-danger:hover {
            background: #e53e3e;
        }

        .theme-selector {
            position: relative;
        }

        .theme-btn {
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .theme-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            margin-top: 8px;
            padding: 8px;
            min-width: 150px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .theme-dropdown.active {
            display: block;
        }

        .theme-option {
            padding: 10px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
            color: var(--text-primary);
        }

        .theme-option:hover {
            background: var(--bg-tertiary);
        }

        .hero {
            background: linear-gradient(135deg, var(--bg-tertiary) 0%, var(--bg-secondary) 100%);
            border-bottom: 1px solid var(--border-color);
            padding: 80px 24px;
        }

        .hero-content {
            max-width: 1400px;
            margin: 0 auto;
        }

        .hero h1 {
            font-family: 'Playfair Display', serif;
            font-size: 96px;
            font-weight: 900;
            line-height: 1.1;
            margin-bottom: 24px;
            background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -3px;
            animation: fadeInUp 1s ease-out;
        }

        .hero p {
            font-size: 28px;
            font-family: 'Merriweather', serif;
            color: var(--text-secondary);
            max-width: 700px;
            line-height: 1.6;
            animation: fadeInUp 1s ease-out 0.2s both;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 60px 24px;
            display: grid;
            grid-template-columns: 1fr 360px;
            gap: 80px;
        }

        .main-content {
            min-width: 0;
        }

        .section-title {
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            font-weight: 700;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 32px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border-color);
            position: relative;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 60px;
            height: 2px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
        }

        .article {
            margin-bottom: 48px;
            padding-bottom: 48px;
            border-bottom: 1px solid var(--border-color);
        }

        .article:last-child {
            border-bottom: none;
        }

        .article-meta {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .author-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            overflow: hidden;
        }

        .author-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .author-info {
            display: flex;
            gap: 8px;
            align-items: center;
            font-size: 14px;
            color: var(--text-secondary);
            flex: 1;
        }

        .author-name {
            color: var(--text-primary);
            font-weight: 600;
            cursor: pointer;
        }

        .author-name:hover {
            color: var(--accent-primary);
        }

        .follow-btn {
            background: transparent;
            color: var(--accent-primary);
            border: 1px solid var(--accent-primary);
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .follow-btn:hover {
            background: var(--accent-primary);
            color: white;
        }

        .follow-btn.following {
            background: var(--accent-primary);
            color: white;
        }

        .article h2 {
            font-family: 'Playfair Display', serif;
            font-size: 36px;
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: 16px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            letter-spacing: -0.5px;
        }

        .article h2:hover {
            color: var(--accent-primary);
            transform: translateX(5px);
        }

        .article-preview {
            font-size: 18px;
            font-family: 'Merriweather', serif;
            color: var(--text-secondary);
            margin-bottom: 16px;
            line-height: 1.8;
        }

        .article-content {
            font-family: 'Merriweather', serif;
            font-size: 20px;
            line-height: 1.8;
            color: var(--text-primary);
        }

        .article-content h2 {
            font-family: 'Playfair Display', serif;
            font-size: 32px;
            font-weight: 700;
            margin: 32px 0 16px 0;
            color: var(--text-primary);
        }

        .article-content strong {
            font-weight: 700;
            color: var(--text-primary);
        }

        .article-content em {
            font-style: italic;
            color: var(--text-secondary);
        }

        .article-content p {
            margin-bottom: 24px;
        }

        .article-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 16px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .article-tags {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .tag {
            background-color: var(--bg-tertiary);
            color: var(--text-secondary);
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 500;
            transition: background-color 0.2s;
        }

        .tag:hover {
            background-color: var(--border-color);
            cursor: pointer;
        }

        .article-actions {
            display: flex;
            gap: 16px;
            align-items: center;
            flex-wrap: wrap;
        }

        .action-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            background: transparent;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 14px;
            padding: 6px 12px;
            border-radius: 16px;
            transition: all 0.2s;
        }

        .action-btn:hover {
            background: var(--bg-tertiary);
            color: var(--accent-primary);
        }

        .action-btn.liked {
            color: #f56565;
        }

        .action-btn.favorited {
            color: #ffd700;
        }

        .emoji-picker {
            position: relative;
        }

        .emoji-list {
            display: none;
            position: absolute;
            bottom: 100%;
            left: 0;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 8px;
            gap: 4px;
            margin-bottom: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .emoji-list.active {
            display: flex;
        }

        .emoji-option {
            font-size: 20px;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 6px;
            transition: background 0.2s;
        }

        .emoji-option:hover {
            background: var(--bg-tertiary);
        }

        .sidebar {
            position: sticky;
            top: 100px;
            height: fit-content;
        }

        .sidebar-section {
            margin-bottom: 48px;
        }

        .trending-item {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
        }

        .trending-number {
            font-family: 'Playfair Display', serif;
            font-size: 36px;
            font-weight: 900;
            color: var(--border-color);
            opacity: 0.5;
        }

        .trending-content h3 {
            font-family: 'Inter', sans-serif;
            font-size: 15px;
            font-weight: 600;
            line-height: 1.5;
            margin-bottom: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .trending-content h3:hover {
            color: var(--accent-primary);
            transform: translateX(5px);
        }

        .trending-author {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .topics {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .topic-tag {
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.2s;
            border: 1px solid transparent;
        }

        .topic-tag:hover {
            background-color: var(--border-color);
            border-color: var(--accent-primary);
            cursor: pointer;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            margin: 20px;
        }

        .modal-header {
            margin-bottom: 24px;
        }

        .modal-header h2 {
            font-family: 'Spectral', serif;
            font-size: 32px;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .modal-header p {
            color: var(--text-secondary);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-primary);
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px 16px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 14px;
            font-family: 'Inter', sans-serif;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--accent-primary);
        }

        .form-group textarea {
            min-height: 200px;
            resize: vertical;
        }

        .form-hint {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        .modal-actions button {
            flex: 1;
        }

        .close-modal {
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }

        .close-modal:hover {
            border-color: var(--accent-primary);
            color: var(--accent-primary);
        }

        .error-message {
            background: rgba(245, 101, 101, 0.1);
            border: 1px solid #f56565;
            color: #f56565;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 16px;
            font-size: 14px;
        }

        .success-message {
            background: rgba(72, 187, 120, 0.1);
            border: 1px solid #48bb78;
            color: #48bb78;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 16px;
            font-size: 14px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .editor-toolbar {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
            padding: 12px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 8px 8px 0 0;
        }

        .toolbar-btn {
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
        }

        .toolbar-btn:hover {
            border-color: var(--accent-primary);
            color: var(--accent-primary);
        }

        #articleContent {
            border-radius: 0 0 8px 8px;
            margin-top: -1px;
        }

        .google-btn {
            width: 100%;
            background: white;
            color: #444;
            border: 1px solid #ddd;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 20px;
            transition: background 0.2s;
        }

        .google-btn:hover {
            background: #f8f8f8;
        }

        .divider {
            text-align: center;
            margin: 20px 0;
            color: var(--text-muted);
            position: relative;
        }

        .divider::before,
        .divider::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 45%;
            height: 1px;
            background: var(--border-color);
        }

        .divider::before {
            left: 0;
        }

        .divider::after {
            right: 0;
        }

        .profile-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .profile-header {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 40px;
            margin-bottom: 40px;
        }

        .profile-top {
            display: flex;
            gap: 24px;
            align-items: start;
            margin-bottom: 24px;
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            font-weight: 700;
            overflow: hidden;
        }

        .profile-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .profile-info {
            flex: 1;
        }

        .profile-name {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .profile-bio {
            color: var(--text-secondary);
            margin-bottom: 16px;
        }

        .profile-stats {
            display: flex;
            gap: 24px;
            margin-bottom: 16px;
        }

        .profile-stat {
            display: flex;
            flex-direction: column;
        }

        .profile-stat-value {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .profile-stat-label {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .profile-tabs {
            display: flex;
            gap: 24px;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 32px;
        }

        .profile-tab {
            padding: 12px 0;
            cursor: pointer;
            color: var(--text-secondary);
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }

        .profile-tab.active {
            color: var(--accent-primary);
            border-bottom-color: var(--accent-primary);
        }

        .profile-tab:hover {
            color: var(--accent-primary);
        }

        .avatar-upload {
            position: relative;
            cursor: pointer;
        }

        .avatar-upload input {
            display: none;
        }

        .avatar-upload-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.2s;
            color: white;
            font-size: 12px;
        }

        .avatar-upload:hover .avatar-upload-overlay {
        opacity: 1;
        }

        .chat-widget {
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 999;
        }

        .chat-button {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
            border: 3px solid var(--accent-primary);
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4), 0 0 0 0 var(--accent-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            transition: all 0.3s ease;
            overflow: hidden;
            animation: pulse 2s ease-in-out infinite;
            padding: 5px;
        }

        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4), 0 0 0 0 var(--accent-primary);
            }
            50% {
                box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4), 0 0 0 10px transparent;
            }
        }

        .chat-button:hover {
            transform: scale(1.15) rotate(5deg);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
            animation: none;
        }

        .chat-button img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .chat-window {
            display: none;
            position: fixed;
            bottom: 110px;
            right: 24px;
            width: 380px;
            height: 550px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
            flex-direction: column;
            overflow: hidden;
        }

        .chat-window.active {
            display: flex;
        }

        .chat-window.minimized {
            height: 60px;
        }

        .chat-header {
            background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
            padding: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }

        .chat-header h3 {
            color: white;
            font-size: 16px;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .chat-controls {
            display: flex;
            gap: 8px;
        }

        .chat-control-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }

        .chat-control-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .chat-messages {
            flex: 1;
            padding: 16px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .chat-message {
            padding: 12px;
            border-radius: 12px;
            max-width: 80%;
            word-wrap: break-word;
        }

        .chat-message.user {
            background: var(--accent-primary);
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 4px;
        }

        .chat-message.bot {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            align-self: flex-start;
            border-bottom-left-radius: 4px;
        }

        .chat-input-area {
            padding: 16px;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 8px;
        }

        .chat-input {
            flex: 1;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 10px 16px;
            color: var(--text-primary);
            font-size: 14px;
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--accent-primary);
        }

        .chat-send-btn {
            background: var(--accent-primary);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }

        .chat-send-btn:hover {
            background: var(--accent-secondary);
        }

        .typing-indicator {
            display: none;
            padding: 12px;
            background: var(--bg-tertiary);
            border-radius: 12px;
            max-width: 60px;
            align-self: flex-start;
        }

        .typing-indicator.active {
            display: block;
        }

        .typing-indicator span {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--text-secondary);
            margin: 0 2px;
            animation: typing 1.4s infinite;
        }

        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-10px);
            }
        }

        @media (max-width: 1024px) {
            .container {
                grid-template-columns: 1fr;
                gap: 40px;
            }

            .sidebar {
                position: static;
            }

            .hero h1 {
                font-size: 64px;
            }
        }

        @media (max-width: 768px) {
            .hero h1 {
                font-size: 48px;
            }

            .hero p {
                font-size: 18px;
            }

            .article h2 {
                font-size: 24px;
            }

            nav {
                gap: 8px;
            }

            nav a:not(#authButtons a) {
                display: none;
            }

            .theme-selector {
                display: none;
            }

            .btn-primary {
                padding: 8px 16px;
                font-size: 12px;
            }

            .profile-top {
                flex-direction: column;
            }

            .profile-stats {
                flex-direction: column;
                gap: 12px;
            }
        }
    </style>
</head>
<body data-theme="dark">
    <div class="reading-progress" id="readingProgress"></div>
    <header>
        <div class="header-content">
            <div class="logo" onclick="app.loadHome()">Lazarus</div>
            <nav>
                <a onclick="app.loadHome()">Home</a>
                <a id="writeBtn" onclick="app.openEditor()" style="display: none;">Write</a>
                <div class="theme-selector">
                    <button class="theme-btn" onclick="app.toggleThemeDropdown()">
                        üé® Theme
                    </button>
                    <div class="theme-dropdown" id="themeDropdown">
                        <div class="theme-option" onclick="app.setTheme('dark')">üåô Dark</div>
                        <div class="theme-option" onclick="app.setTheme('light')">‚òÄÔ∏è Light</div>
                        <div class="theme-option" onclick="app.setTheme('ocean')">üåä Ocean</div>
                        <div class="theme-option" onclick="app.setTheme('forest')">üå≤ Forest</div>
                        <div class="theme-option" onclick="app.setTheme('sunset')">üåÖ Sunset</div>
                        <div class="theme-option" onclick="app.setTheme('cyberpunk')">ü§ñ Cyberpunk</div>
                        <div class="theme-option" onclick="app.setTheme('cherry')">üçí Cherry</div>
                        <div class="theme-option" onclick="app.setTheme('golden')">‚ú® Golden</div>
                        <div class="theme-option" onclick="app.setTheme('aurora')">üåå Aurora</div>
                        <div class="theme-option" onclick="app.setTheme('lavender')">üíú Lavender</div>
                        <div class="theme-option" onclick="app.setTheme('mint')">üåø Mint</div>
                        <div class="theme-option" onclick="app.setTheme('rose')">üåπ Rose</div>
                        <div class="theme-option" onclick="app.setTheme('galaxy')">üå† Galaxy</div>
                        <div class="theme-option" onclick="app.setTheme('fire')">üî• Fire</div>
                    </div>
                </div>
                <div id="authButtons">
                    <a onclick="app.openModal('login')">Sign in</a>
                    <button class="btn-primary" onclick="app.openModal('register')">Get started</button>
                </div>
                <div id="userMenu" style="display: none;">
                    <div class="user-info">
                        <div class="author-avatar" id="userAvatar" onclick="app.viewProfile(app.currentUser?.id)"></div>
                        <span id="userName" onclick="app.viewProfile(app.currentUser?.id)" style="cursor: pointer;"></span>
                        <button class="btn-secondary" onclick="app.logout()">Logout</button>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <section class="hero" id="heroSection">
        <div class="hero-content">
            <h1>Stay curious.</h1>
            <p>Discover stories, thinking, and expertise from writers on any topic.</p>
        </div>
    </section>

    <div class="container">
        <main class="main-content" id="mainContent">
        </main>

        <aside class="sidebar" id="sidebar">
            <div class="sidebar-section">
                <div class="section-title">Trending on Lazarus</div>
                <div id="trendingList"></div>
            </div>

            <div class="sidebar-section">
                <div class="section-title">Discover More Topics</div>
                <div class="topics">
                    <span class="topic-tag">Programming</span>
                    <span class="topic-tag">Artificial Intelligence</span>
                    <span class="topic-tag">Design</span>
                    <span class="topic-tag">Startup</span>
                    <span class="topic-tag">Creativity</span>
                    <span class="topic-tag">Health</span>
                    <span class="topic-tag">Science</span>
                    <span class="topic-tag">Politics</span>
                    <span class="topic-tag">Culture</span>
                    <span class="topic-tag">Travel</span>
                </div>
            </div>
        </aside>
    </div>

    <div id="authModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Welcome to Lazarus</h2>
                <p id="modalSubtitle">Sign in to continue</p>
            </div>
            <div id="modalMessage"></div>
            
            <div id="googleSignInBtn"></div>
            
            <div class="divider">OR</div>
            
            <form id="authForm">
                <div class="form-group" id="nameGroup" style="display: none;">
                    <label for="fullName">Full Name</label>
                    <input type="text" id="fullName" placeholder="Enter your full name">
                </div>
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" placeholder="Enter your email" required>
                    <div class="form-hint">Please enter a valid email address</div>
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" placeholder="Enter your password" required>
                    <div class="form-hint" id="passwordHint">Must be at least 8 characters with uppercase, lowercase, and numbers</div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="close-modal" onclick="app.closeModal()">Cancel</button>
                    <button type="submit" class="btn-primary" id="authSubmit">Continue</button>
                </div>
                <div style="text-align: center; margin-top: 16px;">
                    <a onclick="app.openForgotPassword()" style="color: var(--accent-primary); cursor: pointer; font-size: 14px;">Forgot password?</a>
                </div>
            </form>
        </div>
    </div>

    <div id="editorModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2>Write Your Story</h2>
                <p>Share your thoughts with the world</p>
            </div>
            <div id="editorMessage"></div>
            <form id="articleForm">
                <div class="form-group">
                    <label for="articleTitle">Title</label>
                    <input type="text" id="articleTitle" placeholder="Enter article title" required>
                </div>
                <div class="form-group">
                    <label for="articleTags">Tags (comma separated)</label>
                    <input type="text" id="articleTags" placeholder="e.g., Technology, Programming, AI">
                </div>
                <div class="form-group">
                    <label for="articleContent">Content</label>
                    <div class="editor-toolbar">
                        <button type="button" class="toolbar-btn" onclick="app.formatText('bold')" title="Bold (Ctrl+B)">
                            <i class="fas fa-bold"></i>
                        </button>
                        <button type="button" class="toolbar-btn" onclick="app.formatText('italic')" title="Italic (Ctrl+I)">
                            <i class="fas fa-italic"></i>
                        </button>
                        <button type="button" class="toolbar-btn" onclick="app.formatText('heading')" title="Heading">
                            <i class="fas fa-heading"></i>
                        </button>
                        <button type="button" class="toolbar-btn" onclick="app.formatText('quote')" title="Quote">
                            <i class="fas fa-quote-right"></i>
                        </button>
                        <button type="button" class="toolbar-btn" onclick="app.formatText('code')" title="Code">
                            <i class="fas fa-code"></i>
                        </button>
                        <button type="button" class="toolbar-btn" onclick="app.formatText('list')" title="List">
                            <i class="fas fa-list"></i>
                        </button>
                    </div>
                    <textarea id="articleContent" placeholder="Write your story here... 

Use **bold** for emphasis
Use *italic* for subtle emphasis  
Use ## for headings

Pro tip: Focus on telling your unique story!" required></textarea>
                    <div style="margin-top: 8px; font-size: 12px; color: var(--text-muted);">
                        <i class="fas fa-info-circle"></i> Markdown supported: **bold**, *italic*, ## headings
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="close-modal" onclick="app.closeEditorModal()">Cancel</button>
                    <button type="submit" class="btn-primary">Publish</button>
                </div>
            </form>
        </div>
    </div>

    <div id="profileModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>Edit Profile</h2>
                <p>Update your public profile information</p>
            </div>
            <div id="profileMessage"></div>
            <form id="profileForm">
                <div class="form-group">
                    <label>Profile Picture</label>
                    <div class="avatar-upload" onclick="document.getElementById('avatarInput').click()">
                        <div class="profile-avatar" id="editAvatar"></div>
                        <div class="avatar-upload-overlay">Change</div>
                        <input type="file" id="avatarInput" accept="image/*" onchange="app.handleAvatarUpload(event)">
                    </div>
                    <div class="form-hint">Click to upload a new profile picture</div>
                </div>
                <div class="form-group">
                    <label for="profileName">Display Name</label>
                    <input type="text" id="profileName" placeholder="Your display name" required>
                </div>
                <div class="form-group">
                    <label for="profileBio">Bio</label>
                    <textarea id="profileBio" placeholder="Tell us about yourself..." style="min-height: 100px;"></textarea>
                </div>
                <div class="form-group">
                    <label for="profileArtwork">Favorite Artwork/Quote</label>
                    <input type="text" id="profileArtwork" placeholder="Share your favorite piece">
                </div>
                <div class="modal-actions">
                    <button type="button" class="close-modal" onclick="app.closeProfileModal()">Cancel</button>
                    <button type="submit" class="btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <div id="forgotPasswordModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Reset Password</h2>
                <p>Enter your email to receive a password reset link</p>
            </div>
            <div id="forgotMessage"></div>
            <form id="forgotPasswordForm">
                <div class="form-group">
                    <label for="resetEmail">Email</label>
                    <input type="email" id="resetEmail" placeholder="Enter your email" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="close-modal" onclick="app.closeForgotPassword()">Cancel</button>
                    <button type="submit" class="btn-primary">Send Reset Link</button>
                </div>
            </form>
        </div>
    </div>

    <div id="resetPasswordModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create New Password</h2>
                <p>Enter your new password</p>
            </div>
            <div id="resetMessage"></div>
            <form id="resetPasswordForm">
                <div class="form-group">
                    <label for="newPassword">New Password</label>
                    <input type="password" id="newPassword" placeholder="Enter new password" required>
                    <div class="form-hint">Must be at least 8 characters with uppercase, lowercase, and numbers</div>
                </div>
                <div class="form-group">
                    <label for="confirmPassword">Confirm Password</label>
                    <input type="password" id="confirmPassword" placeholder="Confirm new password" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="close-modal" onclick="app.closeResetPassword()">Cancel</button>
                    <button type="submit" class="btn-primary">Reset Password</button>
                </div>
            </form>
        </div>
    </div>

    <div class="chat-widget">
        <button class="chat-button" onclick="app.toggleChat()">
            <img src="https://i.imgur.com/vJXnK8h.png" alt="Wolf from Nu Pogodi" 
                 onerror="this.onerror=null; this.outerHTML='üê∫';" 
                 style="width: 90%; height: 90%; object-fit: contain;">
        </button>
        <div class="chat-window" id="chatWindow">
            <div class="chat-header" onclick="app.toggleMinimizeChat()">
                <h3><i class="fas fa-robot"></i> Wolf Assistant</h3>
                <div class="chat-controls">
                    <button class="chat-control-btn" onclick="event.stopPropagation(); app.toggleMinimizeChat()">
                        <span id="minimizeIcon">‚àí</span>
                    </button>
                    <button class="chat-control-btn" onclick="event.stopPropagation(); app.closeChat()">√ó</button>
                </div>
            </div>
            <div class="chat-messages" id="chatMessages">
                <div class="chat-message bot">
                    Hello! I'm Wolf from Nu, Pogodi! üê∫ Your Lazarus assistant! Ask me anything about the platform, writing tips, or just chat!
                </div>
            </div>
            <div class="typing-indicator" id="typingIndicator">
                <span></span><span></span><span></span>
            </div>
            <div class="chat-input-area">
                <input type="text" class="chat-input" id="chatInput" placeholder="Ask Wolf anything..." onkeypress="if(event.key==='Enter') app.sendChatMessage()">
                <button class="chat-send-btn" onclick="app.sendChatMessage()">‚û§</button>
            </div>
        </div>
    </div>

    <script>
        const app = {
            currentUser: null,
            currentTheme: 'dark',
            googleInitialized: false,
            chatMinimized: false,
            googleClientId: 'YOUR_GOOGLE_CLIENT_ID.apps.googleusercontent.com',
            
            init() {
                this.loadTheme();
                this.loadUser();
                this.loadArticles();
                this.setupEventListeners();
                this.checkResetToken();
                this.initGoogleAuth();
            },

            setupEventListeners() {
                document.getElementById('authForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.handleAuth();
                });

                document.getElementById('articleForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.publishArticle();
                });

                document.getElementById('profileForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.saveProfile();
                });

                document.getElementById('forgotPasswordForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.sendResetEmail();
                });

                document.getElementById('resetPasswordForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.resetPassword();
                });

                document.addEventListener('click', (e) => {
                    if (!e.target.closest('.theme-selector')) {
                        document.getElementById('themeDropdown').classList.remove('active');
                    }
                });
            },

            initGoogleAuth() {
                if (typeof google !== 'undefined' && google.accounts) {
                    google.accounts.id.initialize({
                        client_id: this.googleClientId,
                        callback: this.handleGoogleSignIn.bind(this)
                    });

                    google.accounts.id.renderButton(
                        document.getElementById('googleSignInBtn'),
                        {
                            theme: 'outline',
                            size: 'large',
                            width: '100%',
                            text: 'continue_with'
                        }
                    );
                    this.googleInitialized = true;
                } else {
                    setTimeout(() => this.initGoogleAuth(), 100);
                }
            },

            handleGoogleSignIn(response) {
                try {
                    const payload = JSON.parse(atob(response.credential.split('.')[1]));
                    
                    let users = JSON.parse(localStorage.getItem('users') || '[]');
                    let user = users.find(u => u.email === payload.email);
                    
                    if (!user) {
                        user = {
                            id: Date.now().toString(),
                            email: payload.email,
                            password: 'google-oauth-' + Math.random().toString(36).substr(2, 9),
                            name: payload.name,
                            avatar: payload.picture || null,
                            bio: '',
                            artwork: '',
                            followers: [],
                            following: [],
                            favorites: []
                        };
                        users.push(user);
                        localStorage.setItem('users', JSON.stringify(users));
                    }
                    
                    this.currentUser = user;
                    localStorage.setItem('currentUser', JSON.stringify(user));
                    this.closeModal();
                    this.updateUI();
                } catch (error) {
                    console.error('Google Sign-In error:', error);
                    this.showMessage('modalMessage', 'Google Sign-In failed. Please try again.', 'error');
                }
            },

            checkResetToken() {
                const urlParams = new URLSearchParams(window.location.search);
                const token = urlParams.get('reset_token');
                const email = urlParams.get('email');
                
                if (token && email) {
                    const resetTokens = JSON.parse(localStorage.getItem('resetTokens') || '{}');
                    const storedToken = resetTokens[email];
                    
                    if (storedToken && storedToken.token === token && storedToken.expires > Date.now()) {
                        document.getElementById('resetPasswordModal').classList.add('active');
                        document.getElementById('resetPasswordModal').dataset.email = email;
                    } else {
                        alert('Invalid or expired reset link');
                        window.history.replaceState({}, document.title, window.location.pathname);
                    }
                }
            },

            loadTheme() {
                const savedTheme = localStorage.getItem('theme') || 'dark';
                this.setTheme(savedTheme);
            },

            setTheme(theme) {
                document.body.setAttribute('data-theme', theme);
                this.currentTheme = theme;
                localStorage.setItem('theme', theme);
                document.getElementById('themeDropdown').classList.remove('active');
            },

            toggleThemeDropdown() {
                document.getElementById('themeDropdown').classList.toggle('active');
            },

            loadUser() {
                const user = localStorage.getItem('currentUser');
                if (user) {
                    this.currentUser = JSON.parse(user);
                    this.updateUI();
                }
            },

            updateUI() {
                if (this.currentUser) {
                    document.getElementById('authButtons').style.display = 'none';
                    document.getElementById('userMenu').style.display = 'block';
                    document.getElementById('writeBtn').style.display = 'block';
                    document.getElementById('userName').textContent = this.currentUser.name;
                    
                    const userAvatar = document.getElementById('userAvatar');
                    if (this.currentUser.avatar) {
                        userAvatar.innerHTML = `<img src="${this.currentUser.avatar}" alt="${this.currentUser.name}">`;
                    } else {
                        userAvatar.textContent = this.getInitials(this.currentUser.name);
                    }
                } else {
                    document.getElementById('authButtons').style.display = 'flex';
                    document.getElementById('userMenu').style.display = 'none';
                    document.getElementById('writeBtn').style.display = 'none';
                }
            },

            getInitials(name) {
                return name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);
            },

            validateEmail(email) {
                const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return re.test(email);
            },

            validatePassword(password) {
                const hasUpperCase = /[A-Z]/.test(password);
                const hasLowerCase = /[a-z]/.test(password);
                const hasNumbers = /\d/.test(password);
                const hasMinLength = password.length >= 8;
                
                return hasUpperCase && hasLowerCase && hasNumbers && hasMinLength;
            },

            openModal(type) {
                const modal = document.getElementById('authModal');
                const nameGroup = document.getElementById('nameGroup');
                const title = document.getElementById('modalTitle');
                const subtitle = document.getElementById('modalSubtitle');
                const submit = document.getElementById('authSubmit');
                const passwordHint = document.getElementById('passwordHint');

                if (type === 'register') {
                    title.textContent = 'Join Lazarus';
                    subtitle.textContent = 'Create your account';
                    nameGroup.style.display = 'block';
                    passwordHint.style.display = 'block';
                    submit.textContent = 'Sign Up';
                    submit.dataset.action = 'register';
                } else {
                    title.textContent = 'Welcome Back';
                    subtitle.textContent = 'Sign in to continue';
                    nameGroup.style.display = 'none';
                    passwordHint.style.display = 'none';
                    submit.textContent = 'Sign In';
                    submit.dataset.action = 'login';
                }

                modal.classList.add('active');
            },

            closeModal() {
                document.getElementById('authModal').classList.remove('active');
                document.getElementById('authForm').reset();
                document.getElementById('modalMessage').innerHTML = '';
            },

            handleAuth() {
                const action = document.getElementById('authSubmit').dataset.action;
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                const name = document.getElementById('fullName').value;

                if (!this.validateEmail(email)) {
                    this.showMessage('modalMessage', 'Please enter a valid email address', 'error');
                    return;
                }

                if (action === 'register') {
                    if (!name || name.trim().length < 2) {
                        this.showMessage('modalMessage', 'Please enter a valid name', 'error');
                        return;
                    }

                    if (!this.validatePassword(password)) {
                        this.showMessage('modalMessage', 'Password must be at least 8 characters with uppercase, lowercase, and numbers', 'error');
                        return;
                    }

                    this.register(email, password, name.trim());
                } else {
                    this.login(email, password);
                }
            },

            register(email, password, name) {
                let users = JSON.parse(localStorage.getItem('users') || '[]');
                
                if (users.find(u => u.email === email)) {
                    this.showMessage('modalMessage', 'Email already registered', 'error');
                    return;
                }

                const user = {
                    id: Date.now().toString(),
                    email,
                    password,
                    name,
                    avatar: null,
                    bio: '',
                    artwork: '',
                    followers: [],
                    following: [],
                    favorites: []
                };

                users.push(user);
                localStorage.setItem('users', JSON.stringify(users));
                
                this.currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(user));
                
                this.closeModal();
                this.updateUI();
                this.showMessage('editorMessage', 'Account created successfully!', 'success');
            },

            login(email, password) {
                const users = JSON.parse(localStorage.getItem('users') || '[]');
                const user = users.find(u => u.email === email && u.password === password);

                if (user) {
                    this.currentUser = user;
                    localStorage.setItem('currentUser', JSON.stringify(user));
                    this.closeModal();
                    this.updateUI();
                } else {
                    this.showMessage('modalMessage', 'Invalid email or password', 'error');
                }
            },

            openForgotPassword() {
                this.closeModal();
                document.getElementById('forgotPasswordModal').classList.add('active');
            },

            closeForgotPassword() {
                document.getElementById('forgotPasswordModal').classList.remove('active');
                document.getElementById('forgotPasswordForm').reset();
                document.getElementById('forgotMessage').innerHTML = '';
            },

            closeResetPassword() {
                document.getElementById('resetPasswordModal').classList.remove('active');
                document.getElementById('resetPasswordForm').reset();
                document.getElementById('resetMessage').innerHTML = '';
                window.history.replaceState({}, document.title, window.location.pathname);
            },

            async sendResetEmail() {
                const email = document.getElementById('resetEmail').value;
                
                if (!this.validateEmail(email)) {
                    this.showMessage('forgotMessage', 'Please enter a valid email address', 'error');
                    return;
                }

                const users = JSON.parse(localStorage.getItem('users') || '[]');
                const user = users.find(u => u.email === email);

                if (!user) {
                    this.showMessage('forgotMessage', 'No account found with this email', 'error');
                    return;
                }

                const resetToken = Math.random().toString(36).substr(2, 9) + Date.now().toString(36);
                const resetTokens = JSON.parse(localStorage.getItem('resetTokens') || '{}');
                
                resetTokens[email] = {
                    token: resetToken,
                    expires: Date.now() + 3600000
                };
                
                localStorage.setItem('resetTokens', JSON.stringify(resetTokens));

                const resetLink = `${window.location.origin}${window.location.pathname}?reset_token=${resetToken}&email=${encodeURIComponent(email)}`;

                try {
                    if (typeof emailjs !== 'undefined') {
                        emailjs.init('YOUR_EMAILJS_PUBLIC_KEY');
                        
                        await emailjs.send('YOUR_SERVICE_ID', 'YOUR_TEMPLATE_ID', {
                            to_email: email,
                            to_name: user.name,
                            reset_link: resetLink,
                            from_name: 'Lazarus'
                        });
                        
                        this.showMessage('forgotMessage', 'Password reset link sent to your email!', 'success');
                    } else {
                        const mailtoLink = `mailto:${email}?subject=Reset Your Lazarus Password&body=Click this link to reset your password: ${resetLink}`;
                        window.open(mailtoLink, '_blank');
                        
                        this.showMessage('forgotMessage', 'Opening email client... Or copy this link: ' + resetLink, 'success');
                    }
                    
                    setTimeout(() => {
                        this.closeForgotPassword();
                    }, 5000);
                } catch (error) {
                    console.error('Email error:', error);
                    this.showMessage('forgotMessage', 'Copy this reset link: ' + resetLink, 'success');
                }
            },

            resetPassword() {
                const newPassword = document.getElementById('newPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                const email = document.getElementById('resetPasswordModal').dataset.email;

                if (!this.validatePassword(newPassword)) {
                    this.showMessage('resetMessage', 'Password must be at least 8 characters with uppercase, lowercase, and numbers', 'error');
                    return;
                }

                if (newPassword !== confirmPassword) {
                    this.showMessage('resetMessage', 'Passwords do not match', 'error');
                    return;
                }

                let users = JSON.parse(localStorage.getItem('users') || '[]');
                const userIndex = users.findIndex(u => u.email === email);

                if (userIndex === -1) {
                    this.showMessage('resetMessage', 'User not found', 'error');
                    return;
                }

                users[userIndex].password = newPassword;
                localStorage.setItem('users', JSON.stringify(users));

                const resetTokens = JSON.parse(localStorage.getItem('resetTokens') || '{}');
                delete resetTokens[email];
                localStorage.setItem('resetTokens', JSON.stringify(resetTokens));

                this.showMessage('resetMessage', 'Password reset successfully!', 'success');
                
                setTimeout(() => {
                    this.closeResetPassword();
                    this.openModal('login');
                }, 2000);
            },

            logout() {
                this.currentUser = null;
                localStorage.removeItem('currentUser');
                this.updateUI();
                this.loadArticles();
            },

            openEditor() {
                if (!this.currentUser) {
                    this.openModal('login');
                    return;
                }
                document.getElementById('editorModal').classList.add('active');
            },

            closeEditorModal() {
                document.getElementById('editorModal').classList.remove('active');
                document.getElementById('articleForm').reset();
                document.getElementById('editorMessage').innerHTML = '';
            },

            formatText(format) {
                const textarea = document.getElementById('articleContent');
                const start = textarea.selectionStart;
                const end = textarea.selectionEnd;
                const selectedText = textarea.value.substring(start, end);
                
                let formattedText = selectedText || 'text';
                let cursorOffset = 0;

                switch(format) {
                    case 'bold':
                        formattedText = `**${formattedText}**`;
                        cursorOffset = selectedText ? 0 : -2;
                        break;
                    case 'italic':
                        formattedText = `*${formattedText}*`;
                        cursorOffset = selectedText ? 0 : -1;
                        break;
                    case 'heading':
                        formattedText = `## ${formattedText}`;
                        break;
                    case 'quote':
                        formattedText = `> ${formattedText}`;
                        break;
                    case 'code':
                        formattedText = `\`${formattedText}\``;
                        cursorOffset = selectedText ? 0 : -1;
                        break;
                    case 'list':
                        formattedText = `- ${formattedText}`;
                        break;
                }

                textarea.value = textarea.value.substring(0, start) + formattedText + textarea.value.substring(end);
                
                const newPosition = selectedText ? end + (formattedText.length - selectedText.length) : start + formattedText.length + cursorOffset;
                textarea.focus();
                textarea.setSelectionRange(newPosition, newPosition);
            },

            publishArticle() {
                if (!this.currentUser) return;

                const title = document.getElementById('articleTitle').value;
                const content = document.getElementById('articleContent').value;
                const tags = document.getElementById('articleTags').value.split(',').map(t => t.trim()).filter(t => t);

                const article = {
                    id: Date.now().toString(),
                    title,
                    content,
                    tags,
                    author: this.currentUser.name,
                    authorId: this.currentUser.id,
                    authorAvatar: this.currentUser.avatar,
                    date: new Date().toLocaleDateString('en-US', { month: 'short', day: 'numeric' }),
                    likes: [],
                    reactions: {},
                    views: 0
                };

                let articles = JSON.parse(localStorage.getItem('articles') || '[]');
                articles.unshift(article);
                localStorage.setItem('articles', JSON.stringify(articles));

                this.closeEditorModal();
                this.loadArticles();
                this.showMessage('editorMessage', 'Article published successfully!', 'success');
            },

            deleteArticle(articleId) {
                if (!confirm('Are you sure you want to delete this article?')) return;

                let articles = JSON.parse(localStorage.getItem('articles') || '[]');
                articles = articles.filter(a => a.id !== articleId);
                localStorage.setItem('articles', JSON.stringify(articles));
                
                this.loadArticles();
            },

            loadArticles() {
                const articles = JSON.parse(localStorage.getItem('articles') || '[]');
                
                if (articles.length === 0) {
                    this.loadDefaultArticles();
                    return;
                }

                const mainContent = document.getElementById('mainContent');
                mainContent.innerHTML = '<div class="section-title">Featured Stories</div>';
                
                articles.forEach(article => {
                    mainContent.innerHTML += this.renderArticle(article);
                });

                this.loadTrending(articles);
            },

            loadDefaultArticles() {
                const defaultArticles = [
                    {
                        id: '1',
                        title: 'The Renaissance of Remote Work: How Technology is Reshaping Our Professional Lives',
                        content: 'As we navigate through unprecedented times, the way we work has fundamentally transformed. This isn\'t just about working from home‚Äîit\'s about reimagining the entire concept of workplace, collaboration, and productivity in the digital age.',
                        tags: ['Technology', 'Future of Work'],
                        author: 'Sarah Mitchell',
                        authorId: 'default1',
                        authorAvatar: null,
                        date: 'Oct 3',
                        likes: [],
                        reactions: {},
                        views: 2400
                    },
                    {
                        id: '2',
                        title: 'Building Resilient Systems: Lessons from Nature\'s Most Adaptive Organisms',
                        content: 'Nature has been engineering resilient systems for billions of years. From the regenerative capabilities of starfish to the adaptive networks of mycelium, there\'s much we can learn about building robust, self-healing systems in software engineering.',
                        tags: ['Engineering', 'Biology'],
                        author: 'James Chen',
                        authorId: 'default2',
                        authorAvatar: null,
                        date: 'Oct 2',
                        likes: [],
                        reactions: {},
                        views: 3100
                    }
                ];

                localStorage.setItem('articles', JSON.stringify(defaultArticles));
                this.loadArticles();
            },

            renderMarkdown(text) {
                if (!text) return '';
                
                if (typeof marked !== 'undefined') {
                    marked.setOptions({
                        breaks: true,
                        gfm: true
                    });
                    return marked.parse(text);
                }
                
                let html = text;
                html = html.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                html = html.replace(/\*(.*?)\*/g, '<em>$1</em>');
                html = html.replace(/^## (.*$)/gm, '<h2>$1</h2>');
                html = html.replace(/^# (.*$)/gm, '<h1>$1</h1>');
                html = html.replace(/\n\n/g, '</p><p>');
                html = '<p>' + html + '</p>';
                html = html.replace(/<p><\/p>/g, '');
                html = html.replace(/<p><h/g, '<h');
                html = html.replace(/<\/h([1-6])><\/p>/g, '</h$1>');
                
                return html;
            },

            renderArticle(article) {
                const isLiked = this.currentUser && article.likes.includes(this.currentUser.id);
                const isFavorited = this.currentUser && this.currentUser.favorites?.includes(article.id);
                const canFollow = this.currentUser && article.authorId !== this.currentUser.id;
                const isFollowing = this.currentUser && this.isFollowing(article.authorId);
                const canDelete = this.currentUser && article.authorId === this.currentUser.id;
                
                const renderedContent = this.renderMarkdown(article.content);
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = renderedContent;
                const plainText = tempDiv.textContent || tempDiv.innerText || '';
                const preview = plainText.substring(0, 200) + (plainText.length > 200 ? '...' : '');
                const readTime = Math.ceil(article.content.split(' ').length / 200);

                const avatarHtml = article.authorAvatar 
                    ? `<img src="${article.authorAvatar}" alt="${article.author}">`
                    : this.getInitials(article.author);

                return `
                    <article class="article">
                        <div class="article-meta">
                            <div class="author-avatar" onclick="app.viewProfile('${article.authorId}')">${avatarHtml}</div>
                            <div class="author-info">
                                <span class="author-name" onclick="app.viewProfile('${article.authorId}')">${article.author}</span>
                                <span>¬∑</span>
                                <span>${article.date}</span>
                            </div>
                            ${canFollow ? `<button class="follow-btn ${isFollowing ? 'following' : ''}" onclick="app.toggleFollow('${article.authorId}')">${isFollowing ? 'Following' : 'Follow'}</button>` : ''}
                            ${canDelete ? `<button class="btn-danger" onclick="app.deleteArticle('${article.id}')"><i class="fas fa-trash"></i> Delete</button>` : ''}
                        </div>
                        <h2>${article.title}</h2>
                        <div class="article-preview">${preview}</div>
                        <div class="article-footer">
                            <div class="article-tags">
                                ${article.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                            </div>
                            <div class="article-actions">
                                <button class="action-btn ${isLiked ? 'liked' : ''}" onclick="app.toggleLike('${article.id}')">
                                    ${isLiked ? '‚ù§Ô∏è' : 'ü§ç'} ${article.likes.length}
                                </button>
                                <button class="action-btn ${isFavorited ? 'favorited' : ''}" onclick="app.toggleFavorite('${article.id}')">
                                    ${isFavorited ? '‚≠ê' : '‚òÜ'}
                                </button>
                                <div class="emoji-picker">
                                    <button class="action-btn" onclick="app.toggleEmojiPicker('${article.id}')">
                                        üòä React
                                    </button>
                                    <div class="emoji-list" id="emoji-${article.id}">
                                        <span class="emoji-option" onclick="app.addReaction('${article.id}', 'üëè')">üëè</span>
                                        <span class="emoji-option" onclick="app.addReaction('${article.id}', 'üî•')">üî•</span>
                                        <span class="emoji-option" onclick="app.addReaction('${article.id}', 'üí°')">üí°</span>
                                        <span class="emoji-option" onclick="app.addReaction('${article.id}', 'üöÄ')">üöÄ</span>
                                        <span class="emoji-option" onclick="app.addReaction('${article.id}', '‚ù§Ô∏è')">‚ù§Ô∏è</span>
                                    </div>
                                </div>
                                <span style="color: var(--text-muted); font-size: 14px;">${readTime} min read</span>
                            </div>
                        </div>
                    </article>
                `;
            },

            toggleLike(articleId) {
                if (!this.currentUser) {
                    this.openModal('login');
                    return;
                }

                let articles = JSON.parse(localStorage.getItem('articles') || '[]');
                const article = articles.find(a => a.id === articleId);
                
                if (!article) return;

                const index = article.likes.indexOf(this.currentUser.id);
                if (index > -1) {
                    article.likes.splice(index, 1);
                } else {
                    article.likes.push(this.currentUser.id);
                }

                localStorage.setItem('articles', JSON.stringify(articles));
                this.loadArticles();
            },

            toggleFavorite(articleId) {
                if (!this.currentUser) {
                    this.openModal('login');
                    return;
                }

                let users = JSON.parse(localStorage.getItem('users') || '[]');
                const userIndex = users.findIndex(u => u.id === this.currentUser.id);
                
                if (userIndex === -1) return;

                if (!users[userIndex].favorites) users[userIndex].favorites = [];
                
                const index = users[userIndex].favorites.indexOf(articleId);
                if (index > -1) {
                    users[userIndex].favorites.splice(index, 1);
                } else {
                    users[userIndex].favorites.push(articleId);
                }

                localStorage.setItem('users', JSON.stringify(users));
                this.currentUser = users[userIndex];
                localStorage.setItem('currentUser', JSON.stringify(this.currentUser));
                this.loadArticles();
            },

            toggleEmojiPicker(articleId) {
                const picker = document.getElementById(`emoji-${articleId}`);
                document.querySelectorAll('.emoji-list').forEach(el => {
                    if (el.id !== `emoji-${articleId}`) el.classList.remove('active');
                });
                picker.classList.toggle('active');
            },

            addReaction(articleId, emoji) {
                if (!this.currentUser) {
                    this.openModal('login');
                    return;
                }

                let articles = JSON.parse(localStorage.getItem('articles') || '[]');
                const article = articles.find(a => a.id === articleId);
                
                if (!article) return;

                if (!article.reactions[emoji]) article.reactions[emoji] = [];
                
                const index = article.reactions[emoji].indexOf(this.currentUser.id);
                if (index > -1) {
                    article.reactions[emoji].splice(index, 1);
                } else {
                    article.reactions[emoji].push(this.currentUser.id);
                }

                localStorage.setItem('articles', JSON.stringify(articles));
                this.toggleEmojiPicker(articleId);
                this.loadArticles();
            },

            toggleFollow(authorId) {
                if (!this.currentUser) {
                    this.openModal('login');
                    return;
                }

                let users = JSON.parse(localStorage.getItem('users') || '[]');
                const currentUserData = users.find(u => u.id === this.currentUser.id);
                const authorData = users.find(u => u.id === authorId);

                if (!currentUserData || !authorData) return;

                const index = currentUserData.following.indexOf(authorId);
                if (index > -1) {
                    currentUserData.following.splice(index, 1);
                    authorData.followers = authorData.followers.filter(id => id !== this.currentUser.id);
                } else {
                    currentUserData.following.push(authorId);
                    if (!authorData.followers) authorData.followers = [];
                    authorData.followers.push(this.currentUser.id);
                }

                localStorage.setItem('users', JSON.stringify(users));
                this.currentUser = currentUserData;
                localStorage.setItem('currentUser', JSON.stringify(currentUserData));
                this.loadArticles();
            },

            isFollowing(authorId) {
                if (!this.currentUser || !this.currentUser.following) return false;
                return this.currentUser.following.includes(authorId);
            },

            loadTrending(articles) {
                const trending = [...articles]
                    .sort((a, b) => b.likes.length - a.likes.length)
                    .slice(0, 5);

                const trendingList = document.getElementById('trendingList');
                trendingList.innerHTML = trending.map((article, index) => `
                    <div class="trending-item">
                        <div class="trending-number">0${index + 1}</div>
                        <div class="trending-content">
                            <h3>${article.title}</h3>
                            <p class="trending-author">by ${article.author}</p>
                        </div>
                    </div>
                `).join('');
            },

            viewProfile(userId) {
                const users = JSON.parse(localStorage.getItem('users') || '[]');
                const user = users.find(u => u.id === userId);
                
                if (!user) return;

                const articles = JSON.parse(localStorage.getItem('articles') || '[]');
                const userArticles = articles.filter(a => a.authorId === userId);
                const favoriteArticles = articles.filter(a => user.favorites?.includes(a.id));

                document.getElementById('heroSection').style.display = 'none';
                document.getElementById('sidebar').style.display = 'none';
                
                const mainContent = document.getElementById('mainContent');
                mainContent.style.maxWidth = '900px';
                mainContent.style.margin = '0 auto';
                
                const avatarHtml = user.avatar 
                    ? `<img src="${user.avatar}" alt="${user.name}">`
                    : this.getInitials(user.name);

                const isOwnProfile = this.currentUser?.id === userId;
                const isFollowing = this.currentUser && this.isFollowing(userId);

                mainContent.innerHTML = `
                    <div class="profile-container">
                        <div class="profile-header">
                            <div class="profile-top">
                                <div class="profile-avatar">${avatarHtml}</div>
                                <div class="profile-info">
                                    <h1 class="profile-name">${user.name}</h1>
                                    ${user.bio ? `<p class="profile-bio">${user.bio}</p>` : ''}
                                    <div class="profile-stats">
                                        <div class="profile-stat">
                                            <span class="profile-stat-value">${userArticles.length}</span>
                                            <span class="profile-stat-label">Articles</span>
                                        </div>
                                        <div class="profile-stat">
                                            <span class="profile-stat-value">${user.followers?.length || 0}</span>
                                            <span class="profile-stat-label">Followers</span>
                                        </div>
                                        <div class="profile-stat">
                                            <span class="profile-stat-value">${user.following?.length || 0}</span>
                                            <span class="profile-stat-label">Following</span>
                                        </div>
                                    </div>
                                    ${user.artwork ? `<p style="color: var(--text-secondary); font-style: italic;">"${user.artwork}"</p>` : ''}
                                    ${isOwnProfile ? '<button class="btn-primary" onclick="app.openProfileEditor()">Edit Profile</button>' : ''}
                                    ${!isOwnProfile && this.currentUser ? `<button class="follow-btn ${isFollowing ? 'following' : ''}" onclick="app.toggleFollow('${userId}')">${isFollowing ? 'Following' : 'Follow'}</button>` : ''}
                                </div>
                            </div>
                        </div>

                        <div class="profile-tabs">
                            <div class="profile-tab active" onclick="app.showProfileTab('articles', '${userId}')">Articles</div>
                            <div class="profile-tab" onclick="app.showProfileTab('favorites', '${userId}')">Favorites</div>
                        </div>

                        <div id="profileContent">
                            ${userArticles.length > 0 ? userArticles.map(a => this.renderArticle(a)).join('') : '<p style="color: var(--text-secondary); text-align: center;">No articles yet</p>'}
                        </div>
                    </div>
                `;
            },

            showProfileTab(tab, userId) {
                const users = JSON.parse(localStorage.getItem('users') || '[]');
                const user = users.find(u => u.id === userId);
                const articles = JSON.parse(localStorage.getItem('articles') || '[]');

                document.querySelectorAll('.profile-tab').forEach(t => t.classList.remove('active'));
                event.target.classList.add('active');

                const content = document.getElementById('profileContent');
                
                if (tab === 'articles') {
                    const userArticles = articles.filter(a => a.authorId === userId);
                    content.innerHTML = userArticles.length > 0 
                        ? userArticles.map(a => this.renderArticle(a)).join('') 
                        : '<p style="color: var(--text-secondary); text-align: center;">No articles yet</p>';
                } else {
                    const favoriteArticles = articles.filter(a => user.favorites?.includes(a.id));
                    content.innerHTML = favoriteArticles.length > 0 
                        ? favoriteArticles.map(a => this.renderArticle(a)).join('') 
                        : '<p style="color: var(--text-secondary); text-align: center;">No favorite articles yet</p>';
                }
            },

            openProfileEditor() {
                if (!this.currentUser) return;

                const modal = document.getElementById('profileModal');
                document.getElementById('profileName').value = this.currentUser.name;
                document.getElementById('profileBio').value = this.currentUser.bio || '';
                document.getElementById('profileArtwork').value = this.currentUser.artwork || '';
                
                const editAvatar = document.getElementById('editAvatar');
                if (this.currentUser.avatar) {
                    editAvatar.innerHTML = `<img src="${this.currentUser.avatar}" alt="${this.currentUser.name}">`;
                } else {
                    editAvatar.textContent = this.getInitials(this.currentUser.name);
                }

                modal.classList.add('active');
            },

            closeProfileModal() {
                document.getElementById('profileModal').classList.remove('active');
                document.getElementById('profileMessage').innerHTML = '';
            },

            handleAvatarUpload(event) {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (e) => {
                    const editAvatar = document.getElementById('editAvatar');
                    editAvatar.innerHTML = `<img src="${e.target.result}" alt="Avatar">`;
                    this.currentUser.avatar = e.target.result;
                };
                reader.readAsDataURL(file);
            },

            saveProfile() {
                if (!this.currentUser) return;

                const name = document.getElementById('profileName').value.trim();
                const bio = document.getElementById('profileBio').value.trim();
                const artwork = document.getElementById('profileArtwork').value.trim();

                if (!name || name.length < 2) {
                    this.showMessage('profileMessage', 'Please enter a valid name', 'error');
                    return;
                }

                let users = JSON.parse(localStorage.getItem('users') || '[]');
                const userIndex = users.findIndex(u => u.id === this.currentUser.id);
                
                if (userIndex === -1) return;

                users[userIndex].name = name;
                users[userIndex].bio = bio;
                users[userIndex].artwork = artwork;
                users[userIndex].avatar = this.currentUser.avatar;

                localStorage.setItem('users', JSON.stringify(users));
                this.currentUser = users[userIndex];
                localStorage.setItem('currentUser', JSON.stringify(this.currentUser));

                let articles = JSON.parse(localStorage.getItem('articles') || '[]');
                articles.forEach(article => {
                    if (article.authorId === this.currentUser.id) {
                        article.author = name;
                        article.authorAvatar = this.currentUser.avatar;
                    }
                });
                localStorage.setItem('articles', JSON.stringify(articles));

                this.closeProfileModal();
                this.updateUI();
                this.viewProfile(this.currentUser.id);
            },

            loadHome() {
                document.getElementById('heroSection').style.display = 'block';
                document.getElementById('sidebar').style.display = 'block';
                const mainContent = document.getElementById('mainContent');
                mainContent.style.maxWidth = '';
                mainContent.style.margin = '';
                this.loadArticles();
            },

            showMessage(elementId, message, type) {
                const element = document.getElementById(elementId);
                element.innerHTML = `<div class="${type}-message">${message}</div>`;
                setTimeout(() => {
                    element.innerHTML = '';
                }, 3000);
            },

            toggleChat() {
                const chatWindow = document.getElementById('chatWindow');
                chatWindow.classList.toggle('active');
                if (chatWindow.classList.contains('active')) {
                    this.chatMinimized = false;
                    chatWindow.classList.remove('minimized');
                    document.getElementById('minimizeIcon').textContent = '‚àí';
                }
            },

            closeChat() {
                document.getElementById('chatWindow').classList.remove('active');
            },

            toggleMinimizeChat() {
                const chatWindow = document.getElementById('chatWindow');
                this.chatMinimized = !this.chatMinimized;
                
                if (this.chatMinimized) {
                    chatWindow.classList.add('minimized');
                    document.getElementById('minimizeIcon').textContent = '‚ñ°';
                } else {
                    chatWindow.classList.remove('minimized');
                    document.getElementById('minimizeIcon').textContent = '‚àí';
                }
            },

            async sendChatMessage() {
                const input = document.getElementById('chatInput');
                const message = input.value.trim();
                
                if (!message) return;

                const messagesContainer = document.getElementById('chatMessages');
                
                messagesContainer.innerHTML += `<div class="chat-message user">${message}</div>`;
                input.value = '';
                messagesContainer.scrollTop = messagesContainer.scrollHeight;

                document.getElementById('typingIndicator').classList.add('active');

                setTimeout(() => {
                    document.getElementById('typingIndicator').classList.remove('active');
                    const response = this.getAIResponse(message);
                    messagesContainer.innerHTML += `<div class="chat-message bot">${response}</div>`;
                    messagesContainer.scrollTop = messagesContainer.scrollHeight;
                }, 1000 + Math.random() * 1000);
            },

            getAIResponse(message) {
                const lowerMessage = message.toLowerCase();

                if (lowerMessage.includes('hello') || lowerMessage.includes('hi') || lowerMessage.includes('hey')) {
                    return "Hello! üê∫ How can I help you today with Lazarus?";
                }

                if (lowerMessage.includes('write') || lowerMessage.includes('article') || lowerMessage.includes('post')) {
                    return "To write an article, click the 'Write' button in the navigation bar (you need to be signed in). Use the formatting toolbar for bold text (**text**), italic (*text*), and headings (## Heading). Happy writing! ‚úçÔ∏è";
                }

                if (lowerMessage.includes('follow') || lowerMessage.includes('followers')) {
                    return "You can follow writers by clicking the 'Follow' button on their articles or profiles. Your followers and following count are visible on your profile page! üë•";
                }

                if (lowerMessage.includes('theme') || lowerMessage.includes('color') || lowerMessage.includes('dark') || lowerMessage.includes('light')) {
                    return "Lazarus has 4 beautiful themes! Click the 'üé® Theme' button in the top navigation to choose between Dark, Light, Ocean, and Forest themes. üåà";
                }

                if (lowerMessage.includes('profile') || lowerMessage.includes('edit profile') || lowerMessage.includes('bio')) {
                    return "Visit your profile by clicking your avatar or name in the top right. Then click 'Edit Profile' to update your display name, bio, profile picture, and favorite artwork quote. Make it yours! üìù";
                }

                if (lowerMessage.includes('like') || lowerMessage.includes('favorite') || lowerMessage.includes('react')) {
                    return "You can ‚ù§Ô∏è like articles, ‚≠ê favorite them for your profile, and add emoji reactions (üëèüî•üí°üöÄ‚ù§Ô∏è). All interactions help surface great content! üéâ";
                }

                if (lowerMessage.includes('delete') || lowerMessage.includes('remove')) {
                    return "You can delete your own articles by clicking the 'Delete' button that appears on articles you've written. Be careful though - this can't be undone! üóëÔ∏è";
                }

                if (lowerMessage.includes('password') || lowerMessage.includes('forgot') || lowerMessage.includes('reset')) {
                    return "If you forgot your password, click 'Forgot password?' on the login screen. You'll receive a reset link to create a new password. üîê";
                }

                if (lowerMessage.includes('google') || lowerMessage.includes('sign in')) {
                    return "You can sign in with Google for quick access! Just click the 'Continue with Google' button on the login screen. üîë";
                }

                if (lowerMessage.includes('trending') || lowerMessage.includes('popular')) {
                    return "Check the sidebar to see trending articles on Lazarus! Trending is based on likes and engagement. üìà";
                }

                if (lowerMessage.includes('nu pogodi') || lowerMessage.includes('wolf') || lowerMessage.includes('–Ω—É–ø–æ–≥–æ–¥–∏') || lowerMessage.includes('–≤–æ–ª–∫')) {
                    return "Ah, you recognized me! üê∫ Yes, I'm inspired by the famous wolf from 'Nu, Pogodi!' - the legendary Soviet cartoon. Just don't expect me to chase any rabbits here! üòÑ";
                }

                if (lowerMessage.includes('help') || lowerMessage.includes('how')) {
                    return "I can help with: writing articles, following users, themes, profiles, likes & reactions, password resets, Google sign-in, and general platform questions. What would you like to know? ü§î";
                }

                if (lowerMessage.includes('thanks') || lowerMessage.includes('thank you')) {
                    return "You're welcome! üê∫ Happy to help anytime!";
                }

                const responses = [
                    "That's an interesting question! Could you be more specific? ü§î",
                    "I'm here to help! Try asking about writing, profiles, themes, or platform features. üê∫",
                    "Hmm, I'm not sure about that one. Ask me about Lazarus features and I'll do my best to help! üí≠",
                    "Great question! You can ask me about writing articles, managing your profile, or using platform features. What interests you? üéØ",
                    "I'm the Wolf assistant - I specialize in helping with Lazarus! Try asking about the platform's features. üê∫‚ú®"
                ];

                return responses[Math.floor(Math.random() * responses.length)];
            }
        };

        // Reading Progress Bar
        window.addEventListener('scroll', () => {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            const progressBar = document.getElementById('readingProgress');
            if (progressBar) {
                progressBar.style.width = scrolled + '%';
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
            app.init();
            
            // Initialize marked.js if available
            if (typeof marked !== 'undefined') {
                marked.setOptions({
                    breaks: true,
                    gfm: true,
                    headerIds: false
                });
            }
        });
    </script>
</body>
</html>
